---
layout: single
title: "[XCode] Unit Test(asynchronous)"
date: 2021-04-09
comments: true
categories:
  - ios
tags: [iOS, XCode]
# 목차
toc: false
toc_sticky: false
---
# XCode 유닛 테스트(asynchronous)

1. 결과를 받을수 있는 코드 블록이 있는 asynchronous함수에 대한 테스트
```swift
XCTestExpectation *expectation = [self expectationWithDescription:@"asynchronous unit test"];
[test asyncHandler:^(BOOL success) {
    XCTAssertTrue(success);
    [expectation fulfill]; // 함수 진행 완료 후 호출
}];
[self waitForExpectationsWithTimeout:3 handler:nil];  // 3초 대기
```  

2. 코드 블록이 없는 asynchronous함수에 대한 테스트
```swift
NSPredicate *predicate = [NSPredicate predicateWithBlock:^BOOL(id  _Nullable evaluatedObject, NSDictionary<NSString *,id> * _Nullable bindings) {
    // 10초 대기 시간 동안 성공할때 까지 연속으로 호출 된다.
    Test* test = (Test*)evaluatedObject;
    BOOL isValid = [test isValid];
    return isValid;
}];
Test *test = [Test new];
XCTNSPredicateExpectation *predicateTestExcectation = [[XCTNSPredicateExpectation alloc]initWithPredicate:predicate object:test];

[test asyncHandler];  // 코드 블록이 없는 asynchronous함수

XCTWaiterResult result = [XCTWaiter waitForExpectations:@[predicateTestExcectation] timeout:10];  // 10초 대기
if(result == XCTWaiterResultCompleted){
    XCTAssertTrue(TRUE, @"Pass");
}else{
    XCTAssertTrue(FALSE, @"Fail");
}
```  
3. UI에 대한 Unit Test
- ui 테스팅 하는 신박한 기능..-_-; accessblily 체크할때 유용할것 같음.
- 로그에 ui 기록 남는게 신기했음.  
4. 기타
@testable import 찾아보기
- swift는 접근자가 있어서 저 키워드가 필요하지만.. objective c 는 필요없음..-_-; 걍 타겟 설정해서 추가하면 될듯..


