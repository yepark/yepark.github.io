---
layout: single
title: "[Swift] Swift 클로저"
date: 2021-04-20
comments: true
categories:
  - Swift
tags: [Swift]
# 목차
toc: true
toc_sticky: true
---

### draft 작성중
## Swift 클로저 ##
내가 클로저를 처음 접한게 자바스크립트 였었는데, 클로저에 대해서 든 생각은 클로저 선언시 해당 상황의 변수들을 캡쳐해서 클로저 함수안에서 사용한다고 이해했었다. 어떻게 보면 Objective-c에 블록이라고 이해하면 되겠다.(정확히는 블록 + 블록함수 선언시 주변의 __block변수)

자바스크립트에서의 클로저
- 자유변수를 클로저가 선언될 당시에 묶인 변수로 만든다.(열린 람다 -> 닫힌 람다로)

자바스크립트의 익명함수와 스위프트 클로저의 차이점
1. swift 기본 클로저
```
// 기본 선언 방식
{ (파라메터) -> 리턴타입 in
  
}
```
위는 일단 스위프트 익명함수 형태임.. 자바스크립트와의 차이점은 function키워드가 없고 중괄호가 밖으로 나왔으며 in 키워드가 있다
그럼 스위프트는 왜 자바스크립트 익명 함수를 클로저라고 부르는걸까 생각 해봤음.
답은 여기에서 얻었음 (https://www.hackingwithswift.com/example-code/language/what-is-a-closure)
스위프트 클로저는 "익명 함수"이고, "변수로 저장" 되고.. "나중에 호출"이 가능하고 "프로그램의 상태 기억"를 기억
역시 자바스크립트의 익명함수랑은 차이가 없는데...-_-;; 라고 생각 되지만..
개념의 차이였음..이라고 말하면 너무 없어 보이는것 같고...

일단 클로저라는 이름 자체가 위에 정의 한대로 '자유변수를 클로저가 선언될 당시에 묶인 변수로 만든다.(열린 람다 -> 닫힌 람다로)' 인데
자바스크립트의 경우 이부분에 예외가 있다.
바로 변수 선언이 모두 전역이라는 것이다. 타입을 선언안하고 이름만 가지고 값을 넣으면 전역이 된다..-_-; 사실 이부분떄문에 자바스크립트를 싫어 하지만..
그래서 자바스크립트는 클로저라는 개념을 도입해서 함수객체 안에 private(외부에 노출안되게) 변수를 사용한다.

어쩄든 스위프트의 경우 클래스 변수가 아닌 일반 함수안에 선언된 변수는 로컬 변수이고, 이 변수가 타입을 안주고 값을 대입한다고 해서 전역변수로 변하지 않는다(var,let 키워드를 뺄수도 없고..)
이차이 때문에 스위프트는 익명함수를 클로저라고 부를수 있다. 바로 값이 캡쳐 된다고 느끼기 때문이다.(자바스크립트는 어차피 전역이라 값이 캡쳐된다고 느껴지지 않는다.)
그래서 애플에서 익명함수를 클로저라고 부른다고 생각한다. 예제를 보자
```
func func1() {
    var num : Int = 2
    var closure = { (a)->Int in
        return a + num
    }

    func2(param: closure)
}

func func2(param : (Int)->Int ){
    print(param(2)) // 4
} 
```
func2 함수 입장에서는 불특정 함수만 파라메터로 받았지만 저 클로저가 캡쳐될 당시의 상황이 파라메터로 들어와있다. func2함수는 로컬 num변수를 알지 못한다. 이부분 떄문에 애플에서 클로저라는 표현을 사용했다고 생각한다.



~~클로저는 중첩함수 + 익명함수~~

그러나 스위프트는 이보다 더 나아가 여러가지 개념이 생겨난거 같다. 클로저는 기본적으로 참조 타입이고 일급 객체의 역할을 한다.
1. 기본 클로저
2. Trailing Closures (후행 클로저)
```
reversedNames = names.sorted() { $0 > $1 } // ()뒤에 선언 생략 가능
```
5. Escaping Closures(탈출 클로저)
6. Autoclosures(자동 클로저)

https://docs.swift.org/swift-book/LanguageGuide/Closures.html
https://hyunseob.github.io/2016/09/17/lambda-anonymous-function-closure/
